<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="../css/master.css" />
  <title>Iniciar Sesión - PUMAF</title>
</head>
<body>
  <header>
    <a href="../index.html"><img class="logoPumaf" src="../img/logo.webp" alt="Logo PUMAF" /></a>
    <nav>
      <ul class="linksPumaf">
        <li><a href="#">Item 1</a></li>
        <li><a href="./reservas.html">Reservas</a></li>
        <li><a href="./login.html">Iniciar Sesión</a></li>
        <li><a href="./registro.html">Registrarse</a></li>
      </ul>
    </nav>
  </header>

  <main class="background">
    <div class="formCampo">
      <h1>Ingresa a PUMAF</h1>
      <hr class="divider" />
      <form id="formLogin" class="formLogin">
        <label for="email">Email</label>
        <input type="email" id="email" placeholder="Ingrese su Email" required />

        <label for="password">Contraseña</label>
        <input type="password" id="password" placeholder="Ingrese su Contraseña" required />

        <button type="submit" class="btn btnForm">Ingresar</button>

        <a href="./recuperarPass.html" class="forgotPass">¿Olvidaste la Contraseña?</a>
      </form>
      <hr class="divider" />
      <h2>¿Aún no estás registrado?</h2>
      <a class="btn btnForm" href="./registro.html">Regístrate</a>
    </div>
  </main>

  <footer>
    <div class="footer">
      <div class="logoFooter"><ion-icon name="tennisball-outline"></ion-icon></div>
      <div class="contacto">
        <p class="footerTitulos">Contacto</p>
        <a href="mailto:pumaf@gmail.com">pumaf@gmail.com</a>
        <a href="tel: 555-555-5555">Tel: 555-555-5555</a>
        <address>Rodriguez 432 - Mendoza</address>
      </div>
      <div class="preguntasFrecuentes">
        <p class="footerTitulos">FAQ</p>
        <a href="./faq.html#nosotros">Sobre Nosotros</a>
        <a href="./faq.html#reservasCanchas">Reservas y Canchas</a>
        <a href="./faq.html#pagosCanchas">Pagos y Canchas</a>
        <a href="./faq.html#otrasPreguntas">Otras Preguntas</a>
      </div>
      <div class="social">
        <p class="footerTitulos">¿Quieres Recibir nuestras últimas novedades?</p>
        <form class="novedadesFormulario">
          <input type="email" placeholder="correo@ejemplo.com" />
          <button type="submit">Suscribirse</button>
        </form>
        <p class="footerTitulos">Nuestras Redes</p>
        <div class="redes">
          <a href="https://www.facebook.com" target="_blank"><ion-icon name="logo-facebook"></ion-icon></a>
          <a href="https://www.instagram.com" target="_blank"><ion-icon name="logo-instagram"></ion-icon></a>
          <a href="https://x.com" target="_blank"><ion-icon name="logo-twitter"></ion-icon></a>
        </div>
      </div>
    </div>
    <div class="legal">PUMAF 2025 &copy; Todos los Derechos Reservados</div>
  </footer>

  <!-- Ionicons -->
  <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
  <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>

  <script>
    document.getElementById('formLogin').addEventListener('submit', async (e) => {
      e.preventDefault();

      const email = document.getElementById('email').value.trim();
      const password = document.getElementById('password').value.trim();

      if (!email || !password) {
        alert('Por favor completá todos los campos.');
        return;
      }

      try {
        const response = await fetch('http://localhost:8081/usuario/login', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ email, password })
        });

        if (!response.ok) {
          throw new Error('Credenciales inválidas');
        }

        const usuario = await response.json();
        sessionStorage.setItem('usuario', JSON.stringify(usuario));
        window.location.href = './perfilUsuario.html?userId=' + usuario.id;

      } catch (err) {
        alert('Error al iniciar sesión: ' + err.message);
      }
    });
  </script>
</body>
</html>
